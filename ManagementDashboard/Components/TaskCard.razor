@using ManagementDashboard.Data.Models

@* TaskCard.razor: Reusable component for displaying a single task in the Eisenhower Matrix *@

<div class="card mb-2 shadow-sm eisenhower-task-card">
    <div class="card-body p-2 d-flex align-items-center justify-content-between">
        <div>
            <span class="fw-bold">@Task.Title</span>
            @if (Task.IsCompleted)
            {
                <span class="badge bg-success ms-2"><i class="bi bi-check-circle me-1"></i>Done</span>
            }
            else if (Task.IsBlocked)
            {
                <span class="badge bg-warning text-dark ms-2"><i class="bi bi-exclamation-triangle me-1"></i>Blocked</span>
            }
            else
            {
                <span class="badge bg-secondary ms-2"><i class="bi bi-hourglass-split me-1"></i>Active</span>
            }
            @* Overdue visual cue (now uses configurable threshold) *@
            @if (Task.Quadrant == "Do" && Task.CompletedAt == null && Task.CreatedAt.AddDays(OverdueThresholdDays) < DateTime.UtcNow)
            {
                <span class="badge bg-danger ms-2"><i class="bi bi-exclamation-circle me-1"></i>Overdue</span>
            }
            @* Priority badge/icon (enum-based, only for Medium/High) *@
            @if (Task.Priority == ManagementDashboard.Data.Models.PriorityLevel.High || Task.Priority == ManagementDashboard.Data.Models.PriorityLevel.Medium)
            {
                var priorityClass = Task.Priority switch
                {
                    ManagementDashboard.Data.Models.PriorityLevel.High => "bg-danger text-white",
                    ManagementDashboard.Data.Models.PriorityLevel.Medium => "bg-warning text-dark",
                    _ => "bg-secondary text-white"
                };
                var priorityIcon = Task.Priority switch
                {
                    ManagementDashboard.Data.Models.PriorityLevel.High => "bi-arrow-up-circle",
                    ManagementDashboard.Data.Models.PriorityLevel.Medium => "bi-arrow-right-circle",
                    _ => "bi-question-circle"
                };
                <span class="badge ms-2 @priorityClass"><i class="bi @priorityIcon me-1"></i>@Task.Priority.ToString()</span>
            }
        </div>
        <div class="btn-group btn-group-sm">
            <button class="btn btn-outline-success" title="Mark Complete" @onclick="OnComplete" disabled="@Task.IsCompleted"><i class="bi bi-check2"></i></button>
            <button class="btn btn-outline-primary" title="Edit" @onclick="OnEdit"><i class="bi bi-pencil"></i></button>
            <button class="btn btn-outline-danger" title="Delete" @onclick="OnDelete"><i class="bi bi-trash"></i></button>
            <button class="btn btn-outline-secondary" title="Audit Trail" @onclick="OnAuditTrail"><i class="bi bi-clock-history"></i></button>
        </div>
    </div>
</div>
